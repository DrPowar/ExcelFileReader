<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:ExcelFileReader.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialIcons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
        mc:Ignorable="d" Width="1400" Height="850" WindowStartupLocation="CenterScreen" CanResize="True"
        x:Class="ExcelFileReader.Views.MainWindow"
        xmlns:converters="clr-namespace:ExcelFileReader.InterfaceConverters;assembly=ExcelFileReader"
        xmlns:models="clr-namespace:ExcelFileReader.Models;assembly=ExcelFileReader"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="ExcelFileReader">

	<Window.Styles>
		<Style Selector="TextBlock">
			<Setter Property="FontFamily" Value="Arial"/>
			<Setter Property="FontSize" Value="18"/>
		</Style>
		<StyleInclude Source="avares://Avalonia.Controls.DataGrid/Themes/Fluent.xaml"/>

		<Style Selector="Button">
			<Setter Property="FontFamily" Value="Arial"/>
			<Setter Property="FontSize" Value="10"/>
		</Style>
	</Window.Styles>

	<Window.Resources>
		<converters:BoolToColorConverter x:Key="BoolToColorConverter"/>
		<models:Person x:Key="Person"/>
	</Window.Resources>

	<Design.DataContext>
		<vm:MainWindowViewModel/>
	</Design.DataContext>
	

	<DockPanel Name="Root">
		<Grid>
			<StackPanel Width="270" DockPanel.Dock="Left" Background="Azure">
				<StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,20,0,20">
					<Button IsEnabled="{Binding CanUploadFile}" Command="{Binding OpenFileButton_Clicked}" Margin="0,0,10,0">
						<TextBlock>Select File</TextBlock>
					</Button>
					<Button IsEnabled="{Binding CanSaveData}" Command="{Binding SaveDataButton_Click}">
						<TextBlock>Save Data</TextBlock>
					</Button>
				</StackPanel>
				<TextBlock HorizontalAlignment="Center" TextWrapping="Wrap" MaxWidth="250" FontSize="22" Text="{Binding UploadingStatus}"/>
			</StackPanel>
		</Grid>


		<Grid DockPanel.Dock="Right" Background="DarkSlateGray">

			<Grid.RowDefinitions>
				<RowDefinition Height="*"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>
			
			<DataGrid
					  Name="PersonsGrid"
					  Margin="10"
					  ItemsSource="{Binding People}"
					  IsReadOnly="False"
					  CanUserSortColumns="True"
					  GridLinesVisibility="All"
					  BorderThickness="1"
					  BorderBrush="Black"
					  Background="Snow"
					  LoadingRow="RowsDataGrid_LoadingRow"
					  RowEditEnded="RowDataGrid_EditingRow"
					  VerticalAlignment="Stretch"
					  HorizontalAlignment="Stretch"
					  SelectionChanged="OnSelectionChanged">
				

				<DataGrid.Columns>
					<DataGridTextColumn Header="Id" Binding="{Binding Id}"/>
					<DataGridTextColumn Header="First Name" Binding="{Binding FirstName}"/>
					<DataGridTextColumn Header="Last Name" Binding="{Binding LastName}" />
					<DataGridTemplateColumn Header="Gender">
						<DataGridTemplateColumn.CellTemplate>
							<DataTemplate>
								<ComboBox SelectedItem="{Binding Gender}"
										  ItemsSource="{Binding #Root.((vm:MainWindowViewModel)DataContext).GenderOptions}"
										  BorderThickness="0"
										  HorizontalAlignment="Center"
										  Background="Transparent"
										  CornerRadius="0"
										  Width="120">
								</ComboBox>
							</DataTemplate>
						</DataGridTemplateColumn.CellTemplate>
					</DataGridTemplateColumn>
					<DataGridTextColumn Header="Country" Binding="{Binding Country}"/>
					<DataGridTextColumn Header="Age" Binding="{Binding Age}"/>
					<DataGridTextColumn Header="Birthday" Binding="{Binding Birthday}"/>
				</DataGrid.Columns>
			</DataGrid>

			<Border Grid.Row="1" Margin="0,10,0,20" HorizontalAlignment="Center"
				Background="Snow" CornerRadius="10">
			
			<StackPanel Orientation="Horizontal">
				<Button Command="{Binding FirstPageCommand}"
						Margin="10,10,0,10">
					&lt;
					&lt;
				</Button>
				<RepeatButton Margin="12,0,0,0"
							  Command="{Binding PreviousPageCommand}">
					&lt;
				</RepeatButton>
				<TextBlock Margin="8,0" VerticalAlignment="Center">
					<TextBlock.Text>
						<MultiBinding StringFormat="Page {0} of {1}">
							<Binding Path="CurrentPage" />
							<Binding Path="TotalPages" />
						</MultiBinding>
					</TextBlock.Text>
				</TextBlock>
				<RepeatButton Command="{Binding NextPageCommand}">
					&gt;
				</RepeatButton>
				<Button Margin="12,10,10,10"
						Command="{Binding LastPageCommand}">
					&gt;
					&gt;
				</Button>
			</StackPanel>
			</Border>

			<Grid Grid.Row="1" HorizontalAlignment="Right" VerticalAlignment="Center">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="Auto"/>
				</Grid.ColumnDefinitions>

				<Border
					Grid.Column="0"
					Margin="0,10,15,20"
					Background="Snow"
					CornerRadius="5">
					<TextBlock Margin="5"
							   Text="{Binding TotalItems, StringFormat={}{0} items}"
							   FontSize="16"/>
				</Border>

				<Border
					Grid.Column="1"
					Margin="0,10,15,20"
					Background="Snow"
					CornerRadius="5">
					<TextBlock Margin="5"
							   Text="{Binding ValidItems, StringFormat={}{0} valid items}"
							   Foreground="#49c46e"
							   FontSize="16"/>
				</Border>

				<Border
					Grid.Column="2"
					Margin="0,10,15,20"
					Background="Snow"
					CornerRadius="5">
					<TextBlock Margin="5"
							   Text="{Binding InValidItems, StringFormat={}{0} invalid items}"
							   Foreground="#ff8a8a"
							   FontSize="16"/>
				</Border>
			</Grid>


		</Grid>

	</DockPanel>

</Window>
