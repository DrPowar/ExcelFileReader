<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:ExcelFileReader.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:materialIcons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
        mc:Ignorable="d" Width="1400" Height="850" WindowStartupLocation="CenterScreen" CanResize="True"
        x:Class="ExcelFileReader.Views.MainWindow"
		xmlns:converters="clr-namespace:ExcelFileReader.InterfaceConverters;assembly=ExcelFileReader"
		xmlns:models="clr-namespace:ExcelFileReader.Models;assembly=ExcelFileReader"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="ExcelFileReader">

	<Window.Styles>
		<Style Selector="TextBlock">
			<Setter Property="FontFamily" Value="Arial"/>
			<Setter Property="FontSize" Value="18"/>
		</Style>
		<StyleInclude Source="avares://Avalonia.Controls.DataGrid/Themes/Fluent.xaml"/>

		<Style Selector="Button">
			<Setter Property="FontFamily" Value="Arial"/>
			<Setter Property="FontSize" Value="10"/>
		</Style>
	</Window.Styles>

	<Window.Resources>
		<converters:BoolToColorConverter x:Key="BoolToColorConverter"/>
		<models:Person x:Key="Person"/>
	</Window.Resources>
	

	<DockPanel>
		<StackPanel Width="270" DockPanel.Dock="Left" Background="Azure">
			<Button HorizontalAlignment="Center" IsEnabled="{Binding CanUploadFile}" VerticalAlignment="Top" Margin="30" Command="{Binding OpenFileButton_Clicked}">
				<TextBlock>Upload File</TextBlock>
			</Button>
			<TextBlock HorizontalAlignment="Center" TextWrapping="Wrap" MaxWidth="250" FontSize="22" Text="{Binding UploadingStatus}">

			</TextBlock>
		</StackPanel>

		<Grid DockPanel.Dock="Right" Background="DarkSlateGray">

			<Grid.RowDefinitions>
				<RowDefinition Height="*"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>
			
			<DataGrid Name="DataRoot"
					  Width="1100"
					  Height="830"
					  Margin="10"
					  ItemsSource="{Binding Persons}"
					  IsReadOnly="False"
					  CanUserSortColumns="True"
					  GridLinesVisibility="All"
					  BorderThickness="1"
					  BorderBrush="Black"
					  Background="Snow"
					  LoadingRow="RowsDataGrid_LoadingRow"
					  RowEditEnded="RowDataGrid_EditingRow">
				

				<DataGrid.Columns>
					<DataGridTextColumn Header="Id" Binding="{Binding Id}"/>
					<DataGridTextColumn Header="First Name" Binding="{Binding FirstName}"/>
					<DataGridTextColumn Header="Last Name" Binding="{Binding LastName}" />
					<DataGridTextColumn Header="Gender" Binding="{Binding Gender}"/>
					<DataGridTextColumn Header="Country" Binding="{Binding Country}"/>
					<DataGridTextColumn Header="Age" Binding="{Binding Age}"/>
					<DataGridTextColumn Header="Birthday" Binding="{Binding Birthday}"/>
				</DataGrid.Columns>
			</DataGrid>

			<StackPanel Grid.Row="1" Margin="0,10" Orientation="Horizontal"
                  HorizontalAlignment="Center">
				<Button Command="{Binding FirstPageCommand}"
						Content="A">
				</Button>
				<RepeatButton Margin="12,0,0,0"
							  Command="{Binding PreviousPageCommand}"
							  Content="A">
				</RepeatButton>
				<TextBlock Margin="8,0" VerticalAlignment="Center">
					<TextBlock.Text>
						<MultiBinding StringFormat="Page {0} of {1}">
							<Binding Path="CurrentPage" />
							<Binding Path="TotalPages" />
						</MultiBinding>
					</TextBlock.Text>
				</TextBlock>
				<RepeatButton Command="{Binding NextPageCommand}"
							  Content="A">
				</RepeatButton>
				<Button Margin="12,0,0,0"
						Command="{Binding LastPageCommand}"
						Content="A">
				</Button>
			</StackPanel>

			<TextBlock Grid.Row="1" Margin="0,0,15,0"
						HorizontalAlignment="Right" VerticalAlignment="Center"
						Text="{Binding TotalItems, StringFormat={}{0} items}"/>

		</Grid>

	</DockPanel>

</Window>
